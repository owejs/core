<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>client.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Api.html">Api</a><ul class='methods'><li data-type='method'><a href="Api.html#catch">catch</a></li><li data-type='method'><a href="Api.html#close">close</a></li><li data-type='method'><a href="Api.html#origin">origin</a></li><li data-type='method'><a href="Api.html#route">route</a></li><li data-type='method'><a href="Api.html#then">then</a></li></ul></li><li><a href="Binding.html">Binding</a><ul class='methods'><li data-type='method'><a href="Binding.html#.bind">bind</a></li><li data-type='method'><a href="Binding.html#.getBinding">getBinding</a></li><li data-type='method'><a href="Binding.html#.isBound">isBound</a></li><li data-type='method'><a href="Binding.html#.unbind">unbind</a></li><li data-type='method'><a href="Binding.html#close">close</a></li><li data-type='method'><a href="Binding.html#route">route</a></li></ul></li><li><a href="ClientApi.html">ClientApi</a><ul class='methods'><li data-type='method'><a href="ClientApi.html#catch">catch</a></li><li data-type='method'><a href="ClientApi.html#close">close</a></li><li data-type='method'><a href="ClientApi.html#observeConnection">observeConnection</a></li><li data-type='method'><a href="ClientApi.html#route">route</a></li><li data-type='method'><a href="ClientApi.html#then">then</a></li><li data-type='method'><a href="ClientApi.html#unobserveConnection">unobserveConnection</a></li></ul></li><li><a href="module-expose-Error.html">Error</a></li><li><a href="module-expose-EvalError.html">EvalError</a></li><li><a href="module-expose-RangeError.html">RangeError</a></li><li><a href="module-expose-ReferenceError.html">ReferenceError</a></li><li><a href="module-expose-SyntaxError.html">SyntaxError</a></li><li><a href="module-expose-TypeError.html">TypeError</a></li><li><a href="module-expose-URIError.html">URIError</a></li><li><a href="State.html">State</a><ul class='methods'><li data-type='method'><a href="State.html#setValue">setValue</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-client.html">client</a></li><li><a href="module-expose.html">expose</a><ul class='methods'><li data-type='method'><a href="module-expose.html#~getValue">getValue</a></li><li data-type='method'><a href="module-expose.html#~isExposed">isExposed</a></li><li data-type='method'><a href="module-expose.html#~properties">properties</a></li></ul></li><li><a href="module-owe-core.html">owe-core</a><ul class='methods'><li data-type='method'><a href="module-owe-core.html">module:owe-core</a></li><li data-type='method'><a href="module-owe-core.html">module:owe-core</a></li><li data-type='method'><a href="module-owe-core.html#~api">api</a></li><li data-type='method'><a href="module-owe-core.html#~isApi">isApi</a></li><li data-type='method'><a href="module-owe-core.html#~isBound">isBound</a></li><li data-type='method'><a href="module-owe-core.html#~isExposed">isExposed</a></li></ul></li><li><a href="module-proxify.html">proxify</a></li><li><a href="module-resource.html">resource</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">client.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";

const ClientApi = require("./ClientApi");

/**
 * Creates a {@link ClientApi} for the given protocol handler.
 * @module client
 * @param {object} protocol The protocol that should be wrapped.
 * @param {function} [protocol.init] Called after the {@link ClientApi} that will be returned is prepared. Gets the Protocol object it was assigned to as its context.
 * @param {function} protocol.closer Called if a route is closed by the used. It gets the route array as its first parameter and the close data as its second. The protocol object the closer was assigned to is used as the context.
 * @return {ClientApi} A ClientApi for protocol.
 */
function client(protocol) {
	if(!protocol || typeof protocol !== "object")
		throw new TypeError("owe ClientApi protocols have to be objects.");

	if(typeof protocol.closer !== "function")
		throw new TypeError("owe ClientApi proctols have to offer a closer function.");

	if(protocol.init &amp;&amp; typeof protocol.init !== "function")
		throw new TypeError("owe ClientApi protocols have to offer an init function.");

	let connected = false;
	const observers = new Set();

	protocol = Object.assign({
		get connected() {
			return connected;
		},
		set connected(value) {
			if(typeof value !== "boolean")
				throw new TypeError("Protocol connection state has to be boolean.");

			if(value === connected)
				return;

			connected = value;
			for(const observer of observers)
				observer(connected);
		},
		observe(observer) {
			if(typeof observer !== "function")
				throw new TypeError("Protocol connection state observers have to be functions.");

			observers.add(observer);
		},
		unobserve(observer) {
			observers.delete(observer);
		}
	}, protocol);

	if(protocol.init)
		protocol.init();

	return new ClientApi(protocol);
}

Object.assign(client, {

	/**
	 * Returns whether the given object is a {@link ClientApi} instance.
	 * @memberof client
	 * @param {any} api The api to check. This can be any value. The method will always return false for non-objects.
	 * @return {boolean} `true` if `api` is a {@link ClientApi}. `false` if not.
	 */
	isApi(api) {
		return api &amp;&amp; typeof api === "object" &amp;&amp; api instanceof ClientApi || false;
	}
});

module.exports = client;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
